#!/bin/bash
#one liner to make sure pinky is running the right model for aider work.
model=${1:-qwen2.5-coder-7b-instruct-mlx}; base=http://pinky:1234/v1; curl -s "$base/models" | jq -e --arg m "$model" '[.data[].id] | index($m)' >/dev/null && curl -s -X POST "$base/chat/completions" -H 'Content-Type: application/json' -d "{\"model\":\"$model\",\"messages\":[{\"role\":\"user\",\"content\":\"ping\"}],\"max_tokens\":1}" | jq -e --arg m "$model" '(.error|not) and (.choices|type=="array") and (.model==$m)' >/dev/null 2>&1 && echo 1 || echo 0
